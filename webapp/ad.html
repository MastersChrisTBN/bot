<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Iklan ‚Äî WebApp</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 16px; background:#f7f7fb; color:#111 }
    .card { background:#fff; border-radius:8px; padding:16px; box-shadow:0 4px 12px rgba(0,0,0,0.06); max-width:720px; margin:24px auto; }
    .center { text-align:center; }
    button { padding:12px 18px; font-size:16px; border-radius:8px; border:none; cursor:pointer; }
    .primary { background:#0b69ff; color:#fff; }
    video { width:100%; border-radius:8px; background:#000; }
  </style>
</head>
<body>
  <div class="card">
    <h2 class="center">üîä Iklan (Demo) ‚Äî Form Login</h2>
    <p>Kami akan menayangkan iklan singkat dulu sebelum proses login. Setelah selesai, tombol akan mengirim tanda kembali ke bot.</p>

    <!--
      CATATAN PENTING:
      - App ID: ca-app-pub-6982383988738663~1641315265
      - Ad unit: ca-app-pub-6982383988738663/5800052121

      - AdMob umumnya ditujukan untuk aplikasi mobile native. Untuk web, gunakan Google AdSense / Google Publisher Tags
        atau integrasi video-ad yang sesuai. Di sini hanya contoh demo (video lokal) untuk meniru pengalaman menayangkan iklan.

      - Jika Anda punya implementasi iklan web yang valid, pasangkan skripnya di sini dan panggil Telegram.WebApp.sendData(...) setelah iklan selesai.
    -->

    <div id="player" style="margin-bottom:12px;">
      <!-- contoh video demo; ganti dengan iklan / player yang sesuai -->
      <video id="adVideo" controls playsinline preload="auto" poster="" >
        <source src="https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4" type="video/mp4">
        Browser Anda tidak mendukung video.
      </video>
    </div>

    <div class="center">
      <button id="playBtn" class="primary">‚ñ∂Ô∏è Putar Iklan</button>
      <button id="closeBtn" style="margin-left:8px;">‚úñ Tutup</button>
    </div>

    <p style="margin-top:12px; font-size:13px; color:#666">Setelah video selesai, halaman akan mengirimkan data kembali ke bot (web_app.sendData).</p>
  </div>

  <script>
    // Pastikan halaman dijalankan sebagai Telegram Web App
    const adVideo = document.getElementById('adVideo');
    const playBtn = document.getElementById('playBtn');
    const closeBtn = document.getElementById('closeBtn');

    function sendResultToBot(payload) {
      try {
        if (window.Telegram && window.Telegram.WebApp && typeof window.Telegram.WebApp.sendData === 'function') {
          window.Telegram.WebApp.sendData(payload);
        } else {
          alert('Demo selesai: ' + payload);
        }
      } catch (e) {
        console.error('sendData error', e);
      }
    }

    playBtn.addEventListener('click', () => {
      adVideo.play().catch(() => {});
    });

    adVideo.addEventListener('ended', () => {
      sendResultToBot('ad_shown');
      if (window.Telegram && window.Telegram.WebApp && typeof window.Telegram.WebApp.close === 'function') {
        setTimeout(() => window.Telegram.WebApp.close(), 700);
      }
    });

    closeBtn.addEventListener('click', () => {
      sendResultToBot('ad_cancelled');
      if (window.Telegram && window.Telegram.WebApp && typeof window.Telegram.WebApp.close === 'function') {
        window.Telegram.WebApp.close();
      }
    });

    if (window.Telegram && window.Telegram.WebApp) {
      try { window.Telegram.WebApp.expand(); } catch (e) {}
    }
  </script>
</body>
</html>
